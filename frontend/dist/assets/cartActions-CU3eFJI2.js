import{i as n,w as a,x as u,y as s,z as i}from"./index-CVeIW3aN.js";const d=(t=!1)=>{const r=t?{summary:"true"}:{};return n.get("/cart/",{params:r})},y=()=>n.get("/cart/count/"),f=(t,r=1)=>n.post("/cart/add/",{product_id:t,quantity:r}),w=(t,r)=>n.patch(`/cart/update/${t}/`,{quantity:r}),g=t=>n.delete(`/cart/remove/${t}/`),C=()=>n.delete("/cart/clear/"),p=t=>n.post("/cart/promo/apply/",{promo_code:t}),v=()=>n.delete("/cart/promo/remove/"),E=(t,r)=>{if(!t)throw new Error("Product is required");if(r<1)throw new Error("Quantity must be at least 1");if(r>t.stock)throw new Error(`Only ${t.stock} items available in stock`);return!0},c=(t=!1)=>async r=>{try{r(a(!0));const e=await d(t);return r(u(e.data)),e.data}catch(e){console.error("Error fetching cart:",e);const o=e.response?.data?.detail||"Failed to fetch cart";r(s(o)),r(u({items:[],total_items:0,subtotal:0,total_amount:0}))}finally{r(a(!1))}},m=()=>async t=>{try{const r=await y();return t(i(r.data.count)),r.data.count}catch(r){console.error("Error fetching cart count:",r),t(i(0))}},F=(t,r=1)=>async e=>{try{e(a(!0));const o=await f(t,r);return e(s("")),await e(c()),await e(m()),o.data}catch(o){console.error("Error adding to cart:",o);const l=o.response?.data?.error||o.response?.data?.detail||"Failed to add item to cart";throw e(s(l)),o}finally{e(a(!1))}},M=t=>async r=>{try{r(a(!0));const e=await g(t);return await r(c()),await r(m()),e.data}catch(e){console.error("Error removing from cart:",e);const o=e.response?.data?.error||"Failed to remove item from cart";throw r(s(o)),e}finally{r(a(!1))}},_=(t,r)=>async e=>{try{e(a(!0));const o=await w(t,r);return await e(c()),await e(m()),o.data}catch(o){console.error("Error updating cart:",o);const l=o.response?.data?.error||"Failed to update cart quantity";throw e(s(l)),o}finally{e(a(!1))}},b=()=>async t=>{try{t(a(!0));const r=await C();return t(u({items:[],total_items:0,subtotal:0,total_amount:0})),t(i(0)),r.data}catch(r){console.error("Error clearing cart:",r);const e=r.response?.data?.error||"Failed to clear cart";throw t(s(e)),r}finally{t(a(!1))}},P=t=>async r=>{try{r(a(!0));const e=await p(t);return await r(c()),e.data}catch(e){console.error("Error applying promo code:",e);const o=e.response?.data?.error||"Failed to apply promo code";throw r(s(o)),e}finally{r(a(!1))}},k=()=>async t=>{try{t(a(!0));const r=await v();return await t(c()),r.data}catch(r){console.error("Error removing promo code:",r);const e=r.response?.data?.error||"Failed to remove promo code";throw t(s(e)),r}finally{t(a(!1))}},Q=(t,r=1)=>async e=>{try{E(t,r);const o=await e(F(t.id,r));return{success:!0,message:`Added ${t.title} to cart`,data:o}}catch(o){return{success:!1,message:o.message||"Failed to add item to cart",error:o}}};export{F as a,Q as b,c,b as d,P as e,m as f,k as g,M as r,_ as u};
