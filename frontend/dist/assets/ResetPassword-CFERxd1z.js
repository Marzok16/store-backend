import{e as R,b as L,r as t,j as e,L as l,d as g}from"./index-CVeIW3aN.js";function E(){const{token:d}=R(),w=L(),[o,h]=t.useState({password:"",confirmPassword:""}),[m,u]=t.useState(!1),[b,f]=t.useState(!0),[p,i]=t.useState(!1),[y,j]=t.useState(""),[c,r]=t.useState(""),[v,N]=t.useState(!1);t.useEffect(()=>{d?(async()=>{try{await g.validateResetToken(d),i(!0)}catch(a){i(!1),r(a.message||"Invalid or expired reset token")}finally{f(!1)}})():(i(!1),f(!1),r("Invalid reset link"))},[d]);const x=n=>{const{name:a,value:s}=n.target;h(S=>({...S,[a]:s}))},k=n=>{const a=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/;return n.length<8?"Password must be at least 8 characters long":a.test(n)?null:"Password must contain at least one special character"},P=async n=>{n.preventDefault();const a=k(o.password);if(a){r(a);return}if(o.password!==o.confirmPassword){r("Passwords do not match");return}try{u(!0),r(""),await g.resetPassword(d,{password:o.password,password_confirm:o.confirmPassword}),N(!0),j("Password reset successfully! You can now log in with your new password."),setTimeout(()=>{w("/login")},3e3)}catch(s){s.response?.data?.password?r(Array.isArray(s.response.data.password)?s.response.data.password[0]:s.response.data.password):s.response?.data?.password_confirm?r(Array.isArray(s.response.data.password_confirm)?s.response.data.password_confirm[0]:s.response.data.password_confirm):r(s.message||"Failed to reset password")}finally{u(!1)}};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto",children:e.jsxs("div",{className:"bg-white p-8 border border-gray-300 rounded-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Validating Reset Link"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we validate your password reset link..."})]})})}):p?v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto",children:e.jsxs("div",{className:"bg-white p-8 border border-gray-300 rounded-lg text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-green-600",children:"Password Reset Successful!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:y}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"You will be redirected to the login page in a few seconds..."}),e.jsx(l,{to:"/login",className:"inline-block bg-[#f0c14b] border border-[#a88734] rounded-md py-2 px-6 text-sm font-medium text-gray-900 hover:bg-[#f4d078] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Go to Sign In"})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center",children:e.jsxs("div",{className:"max-w-md w-full mx-auto",children:[e.jsxs("form",{className:"bg-white p-8 border border-gray-300 rounded-lg",onSubmit:P,children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Reset Your Password"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Enter your new password below."}),c&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:c}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsx("input",{id:"password",name:"password",type:"password",value:o.password,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-[#f0c14b] focus:border-[#a88734] hover:border-[#a88734]",placeholder:"Enter your new password",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Password must be at least 8 characters and contain at least one special character."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-[#f0c14b] focus:border-[#a88734] hover:border-[#a88734]",placeholder:"Confirm your new password",required:!0})]})]}),e.jsx("button",{type:"submit",disabled:m,className:"mt-6 w-full bg-[#f0c14b] border border-[#a88734] rounded-md py-2 px-4 text-sm font-medium text-gray-900 hover:bg-[#f4d078] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Resetting Password...":"Reset Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(l,{to:"/login",className:"text-sm text-blue-600 hover:underline",children:"Back to Sign In"})})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto",children:e.jsxs("div",{className:"bg-white p-8 border border-gray-300 rounded-lg text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-red-600",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 mb-6",children:c}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{to:"/forgot-password",className:"block bg-[#f0c14b] border border-[#a88734] rounded-md py-2 px-4 text-sm font-medium text-gray-900 hover:bg-[#f4d078] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Request New Reset Link"}),e.jsx(l,{to:"/login",className:"block bg-gray-800 text-white rounded-md py-2 px-4 text-sm font-medium hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Back to Sign In"})]})]})})})}export{E as default};
